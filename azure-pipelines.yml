trigger:
  branches:
    include:
      - main

variables:
  imageRepositoryBackend: "feedback-board-backend"
  imageRepositoryFrontend: "feedback-board-frontend"
  containerRegistry: "bodatero.azurecr.io"
  dockerRegistryServiceConnection: "bodatero ACR connection"

pool:
  name: "Default"

stages:
  - stage: Build
    jobs:
      - job: Build_And_Push
        steps:
          - task: Docker@2
            displayName: Build and Push Backend
            inputs:
              command: buildAndPush
              repository: $(imageRepositoryBackend)
              dockerfile: backend/Dockerfile
              containerRegistry: $(dockerRegistryServiceConnection)
              tags: latest

          - task: Docker@2
            displayName: Build and Push Frontend
            inputs:
              command: buildAndPush
              repository: $(imageRepositoryFrontend)
              dockerfile: frontend/Dockerfile
              containerRegistry: $(dockerRegistryServiceConnection)
              tags: latest
